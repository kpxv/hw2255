.global _start

_start:
    movs r0, #7
    movs r1, #21
    b exit
    bl divu

    movs r0, #0
    movs r1, #37
    bl divu

    movs r0, #7
    movs r1, #0
    bl divu

    // Exit
    b exit

divu:
    cmp r0, #0
    // No need to setp carry flag; cmp does it for us
    beq divu_end
    
    push {r2, r3}
    b divu_check

divu_loop:
    lsrs r0, #1

    // Conditional branch to divu_loop
    // TODO

divu_check:
    cmp r0, #1
    bge divu_loop

    // Cleanup
    mrs r0, apsr
    movs r1, #0x20
    lsls r1, r1, #24
    bics r0, r0, r1
    msr apsr, r0
    b divu_end

    pop {r2, r3}

divu_end:
    bx lr


exit:
    movs r7, #1
    swi 0
